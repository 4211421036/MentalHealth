<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Health Monitoring System - FAQ</title>
    <meta name="description" content="Frequently Asked Questions about the Arduino Implementation for Mental Health Monitoring">
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --accent-color: #4fc3f7;
            --background-color: #f5f7fa;
            --text-color: #333;
            --light-text: #666;
            --border-color: #ddd;
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --focus-outline: 2px solid var(--accent-color);
            --link-color: #0056b3;
            --link-hover-color: #003d82;
            --link-decoration: underline;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary-color);
            color: white;
            padding: 8px;
            z-index: 100;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px 0;
            border-bottom: 1px solid var(--border-color);
        }

        h1 {
            color: var(--secondary-color);
            margin-bottom: 10px;
            font-size: 2.2rem;
        }

        .subtitle {
            color: var(--light-text);
            font-size: 1.1rem;
        }

        .faq-section {
            margin-bottom: 40px;
        }

        .section-title {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
        }

        .section-title i {
            margin-right: 10px;
            color: var(--accent-color);
        }

        .faq-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .faq-card {
            background: white;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .faq-card:hover {
            transform: translateY(-5px);
        }

        .faq-question {
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: none;
            width: 100%;
            text-align: left;
        }

        .faq-question:focus {
            outline: var(--focus-outline);
            outline-offset: 2px;
        }

        .faq-answer {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .faq-card.active .faq-answer {
            padding: 20px;
            max-height: 1000px;
        }

        .faq-answer-content {
            padding-bottom: 10px;
        }

        .code-block {
            background-color: #f0f0f0;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
            border-left: 4px solid var(--accent-color);
        }

        .toggle-icon {
            transition: transform 0.3s ease;
            font-weight: bold;
            font-size: 1.3rem;
            min-width: 20px;
            text-align: center;
        }

        .faq-card.active .toggle-icon {
            transform: rotate(45deg);
        }

        .sensor-diagram {
            width: 100%;
            max-width: 500px;
            margin: 20px auto;
            display: block;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
        }

        .reference {
            font-size: 0.9rem;
            color: var(--light-text);
            margin-top: 10px;
            font-style: italic;
        }

        .note {
            background-color: #fff8e1;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
            border-radius: 0 4px 4px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            h1 {
                font-size: 1.8rem;
            }

            .faq-question {
                font-size: 1.1rem;
                padding: 15px;
            }

            .faq-answer {
                padding: 0 15px;
            }

            .faq-card.active .faq-answer {
                padding: 15px;
            }
        }

        /* Focus styles for all focusable elements */
        a:focus, button:focus, input:focus, [tabindex="0"]:focus {
            outline: var(--focus-outline);
            outline-offset: 2px;
        }

        /* Link contrast */
        a {
            color: var(--link-color);
            text-decoration: var(--link-decoration);
            font-weight: bold;
            border-bottom: 2px solid transparent;
        }

        a:hover, a:focus {
            color: var(--link-hover-color);
            border-bottom: 2px solid var(--link-hover-color);
            text-decoration: none;
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link" id="skip-to-content">Skip to main content</a>
    
    <div class="container">
        <header role="banner">
            <h1>Mental Health Monitoring System</h1>
            <p role="text"  class="subtitle">Frequently Asked Questions about the Arduino Implementation</p>
        </header>

        <main id="main-content" role="main">
            <nav aria-label="FAQ Categories">
                <ul class="visually-hidden">
                    <li><a href="#hardware-heading">Hardware Setup</a></li>
                    <li><a href="#code-heading">Code Implementation</a></li>
                    <li><a href="#analysis-heading">Mental Health Analysis</a></li>
                    <li><a href="#upload-heading">Data Upload</a></li>
                </ul>
            </nav>

            <section class="faq-section" aria-labelledby="hardware-heading">
                <h2 id="hardware-heading" class="section-title">
                    <span aria-hidden="true" class="fas fa-microchip"></span>
                    Hardware Setup
                </h2>
                <div class="faq-container">

                    <div class="faq-card">
                        <button id="faq-question-1" class="faq-question" aria-expanded="false" aria-controls="faq-answer-1">
                            What sensors are used in this system?
                            <span class="toggle-icon" aria-hidden="true">+</span>
                        </button>
                        <div id="faq-answer-1" class="faq-answer" role="region" aria-labelledby="faq-question-1">
                            <div class="faq-answer-content">
                                <p role="text" >The system uses three main sensors:</p>
                                <ol>
                                    <li><strong>MAX30102</strong> - Optical heart rate and blood oxygen sensor</li>
                                    <li><strong>GSR Sensor</strong> - Galvanic Skin Response sensor for stress detection</li>
                                    <li><strong>BH1750</strong> - Ambient light sensor</li>
                                </ol>
                                <p role="text" >These sensors work together to collect physiological data that can indicate mental health status.</p>
                                <div class="code-block">
                                    <p role="text" re><code>// Sensor Objects in the code
MAX30105 particleSensor;  // MAX30102 sensor object
BH1750 lightMeter;       // BH1750 light sensor
const int GSR_PIN = 34;  // GSR sensor pin</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="faq-card">
                        <button id="faq-question-2" class="faq-question" aria-expanded="false" aria-controls="faq-answer-2">
                            How are the sensors connected to the microcontroller?
                            <span class="toggle-icon" aria-hidden="true">+</span>
                        </button>
                        <div id="faq-answer-2" class="faq-answer" role="region" aria-labelledby="faq-question-2">
                            <div class="faq-answer-content">
                                <p role="text" >The sensors are connected as follows:</p>
                                <ul>
                                    <li>MAX30102 and BH1750 use I2C communication (connected to SDA and SCL pins)</li>
                                    <li>GSR sensor is connected to analog pin 34</li>
                                </ul>
                                <p role="text" >The code initializes these connections in the <code>setup()</code> function:</p>
                                <div class="code-block">
                                    <p role="text" re><code>void setup() {
  Wire.begin();  // Initialize I2C
  particleSensor.begin(Wire, I2C_SPEED_FAST); // MAX30102
  lightMeter.begin(); // BH1750
  // GSR is analog so only needs pin declaration
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="faq-section" aria-labelledby="code-heading">
                <h2 id="code-heading" class="section-title">
                    <span aria-hidden="true" class="fas fa-code"></span>
                    Code Implementation
                </h2>
                <div class="faq-container">

                    <div class="faq-card">
                        <button id="faq-question-3" class="faq-question" aria-expanded="false" aria-controls="faq-answer-3">
                            How does the heart rate detection work?
                            <span class="toggle-icon" aria-hidden="true">+</span>
                        </button>
                        <div id="faq-answer-3" class="faq-answer" role="region" aria-labelledby="faq-question-3">
                            <div class="faq-answer-content">
                                <p role="text" >The MAX30102 sensor detects heart rate by measuring changes in blood volume using optical technology (PPG). The code implements:</p>
                                <ol>
                                    <li>IR LED shines light into the skin</li>
                                    <li>Photodetector measures reflected light</li>
                                    <li>Pulse detection algorithm identifies beats</li>
                                    <li>Beat-to-beat intervals are calculated for HRV</li>
                                </ol>
                                <div class="code-block">
                                    <p role="text" re><code>if(irValue > 50000) {  // Finger detected
  if(checkForBeat(irValue)) {
    long delta = millis() - lastBeat;
    lastBeat = millis();
    beatsPerMinute = 60000.0 / delta;
  }
}</code></pre>
                                </div>
                                <p role="text"  class="reference">Based on Shaffer et al. (2014) HRV measurement standards</p>
                            </div>
                        </div>
                    </div>

                    <div class="faq-card">
                        <button id="faq-question-4" class="faq-question" aria-expanded="false" aria-controls="faq-answer-4">
                            What is the purpose of the GSR moving average calculation?
                            <span class="toggle-icon" aria-hidden="true">+</span>
                        </button>
                        <div id="faq-answer-4" class="faq-answer" role="region" aria-labelledby="faq-question-4">
                            <div class="faq-answer-content">
                                <p role="text" >The moving average calculation separates the GSR signal into two components:</p>
                                <ul>
                                    <li><strong>Tonic component</strong> (slow-changing baseline)</li>
                                    <li><strong>Phasic component</strong> (fast-changing responses)</li>
                                </ul>
                                <p role="text" >This is implemented with a 5-sample moving average window:</p>
                                <div class="code-block">
                                    <p role="text" re><code>// Moving average for EDA tonic (Boucsein, 2012)
float edaMovingAverage(float newVal) {
  eda_buffer[buffer_index] = newVal;
  buffer_index = (buffer_index + 1) % WINDOW_SIZE;
  float sum = 0;
  for(int i=0; i&lt;WINDOW_SIZE; i++) sum += eda_buffer[i];
  return sum/WINDOW_SIZE;
}</code></pre>
                                </div>
                                <div class="note">
                                    <strong>Note:</strong> The window size of 5 samples was chosen based on Boucsein's (2012) research on electrodermal activity measurement.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="faq-card">
                        <button id="faq-question-5" class="faq-question" aria-expanded="false" aria-controls="faq-answer-5">
                            How is HRV (Heart Rate Variability) calculated?
                            <span class="toggle-icon" aria-hidden="true">+</span>
                        </button>
                        <div id="faq-answer-5" class="faq-answer" role="region" aria-labelledby="faq-question-5">
                            <div class="faq-answer-content">
                                <p role="text" >HRV is calculated using SDNN (Standard Deviation of NN intervals), which is a well-established metric in psychophysiology research (Castaldo et al., 2019).</p>
                                <p role="text" >The code implements this by:</p>
                                <ol>
                                    <li>Storing the last 16 RR intervals (time between heartbeats)</li>
                                    <li>Calculating the mean interval</li>
                                    <li>Computing the standard deviation of these intervals</li>
                                </ol>
                                <div class="code-block">
                                    <p role="text" re><code>// Calculate SDNN (Standard Deviation of NN intervals)
float calculateSDNN() {
  float mean = 0.0f;
  for (int i = 0; i &lt; RR_BUFFER_SIZE; i++) {
    mean += rrIntervals[i];
  }
  mean /= RR_BUFFER_SIZE;
  // ... variance calculation ...
  return sqrt(variance);
}</code></pre>
                                </div>
                                <p role="text" >HRV is an important indicator of autonomic nervous system activity and stress levels.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="faq-section" aria-labelledby="analysis-heading">
                <h2 id="analysis-heading" class="section-title">
                    <span aria-hidden="true" class="fas fa-brain"></span>
                    Mental Health Analysis
                </h2>
                <div class="faq-container">

                    <div class="faq-card">
                        <button id="faq-question-6" class="faq-question" aria-expanded="false" aria-controls="faq-answer-6">
                            How does the neural network predict mental health status?
                            <span class="toggle-icon" aria-hidden="true">+</span>
                        </button>
                        <div id="faq-answer-6" class="faq-answer" role="region" aria-labelledby="faq-question-6">
                            <div class="faq-answer-content">
                                <p role="text" >The system uses a neural network (defined in MentalHealthNN.h) that takes sensor inputs and outputs probabilities for four mental states:</p>
                                <ol>
                                    <li>Normal</li>
                                    <li>Stress</li>
                                    <li>Anxiety</li>
                                    <li>Depression</li>
                                </ol>
                                <p role="text" >The prediction happens in the <code>detectMentalHealth()</code> function:</p>
                                <div class="code-block">
                                    <p role="text" re><code>void detectMentalHealth(float edaTonic, float edaPhasic, float bpm, float hrv, float lux, 
    MentalHealthStatus& status, float* probabilities) {
  // Get prediction from neural network
  status = mentalHealth.predict(edaTonic, edaPhasic, bpm, hrv, lux);
  // Get probabilities for each class
  mentalHealth.getPredictionProbabilities(edaTonic, edaPhasic, bpm, hrv, lux, probabilities);
}</code></pre>
                                </div>
                                <p role="text" >The neural network was likely trained on labeled physiological data from individuals with known mental health conditions.</p>
                            </div>
                        </div>
                    </div>

                    <div class="faq-card">
                        <button id="faq-question-7" class="faq-question" aria-expanded="false" aria-controls="faq-answer-7">
                            What is the significance of the ambient light sensor?
                            <span class="toggle-icon" aria-hidden="true">+</span>
                        </button>
                        <div id="faq-answer-7" class="faq-answer" role="region" aria-labelledby="faq-question-7">
                            <div class="faq-answer-content">
                                <p role="text" >The BH1750 light sensor measures ambient light levels which are important because:</p>
                                <ul>
                                    <li>Light exposure affects circadian rhythms and mood (Golden et al., 2005)</li>
                                    <li>Low light levels may correlate with depressive symptoms</li>
                                    <li>Sudden light changes can indicate environmental stressors</li>
                                </ul>
                                <p role="text" >The light data is read and included in the mental health analysis:</p>
                                <div class="code-block">
                                    <p role="text" re><code>// Read BH1750 ambient light sensor
float lux = lightMeter.readLightLevel();

// Included in neural network input
detectMentalHealth(..., lux, ...);</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="faq-section" aria-labelledby="upload-heading">
                <h2 id="upload-heading" class="section-title">
                    <span aria-hidden="true" class="fas fa-cloud-upload-alt"></span>
                    Data Upload
                </h2>
                <div class="faq-container">

                    <div class="faq-card">
                        <button id="faq-question-8" class="faq-question" aria-expanded="false" aria-controls="faq-answer-8">
                            How does the GitHub data upload work?
                            <span class="toggle-icon" aria-hidden="true">+</span>
                        </button>
                        <div id="faq-answer-8" class="faq-answer" role="region" aria-labelledby="faq-question-8">
                            <div class="faq-answer-content">
                                <p role="text" >The system uploads sensor data to GitHub repositories every 10 seconds using the GitHub API:</p>
                                <ol>
                                    <li>Data is formatted as JSON documents</li>
                                    <li>Base64 encoded for GitHub API requirements</li>
                                    <li>Uploaded using HTTP PUT requests with authentication</li>
                                    <li>SHA hashes are tracked for version control</li>
                                </ol>
                                <div class="code-block">
                                    <p role="text" re><code>// Example of GitHub upload function
void uploadToGitHub(DynamicJsonDocument doc, const char* url, String& lastSHA) {
  HTTPClient http;
  http.begin(url);
  http.addHeader("Content-Type", "application/json");
  http.addHeader("Authorization", token);

  String jsonStr;
  serializeJson(doc, jsonStr);
  String encodedData = base64::encode(jsonStr);

  String payload = "{\"message\":\"Update data\",\"content\":\"" + 
      encodedData + "\",\"sha\":\"" + lastSHA + "\"}";

  int httpCode = http.PUT(payload);
  // ... handle response ...
}</code></pre>
                                </div>
                                <p role="text" >Four separate JSON files are maintained for each sensor type and the mental status.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer role="contentinfo">
            <p role="text" >Mental Health Monitoring System - Version 1.0.2</p>
            <p role="text" >For questions about accessibility, please contact <a href="mailto:support@mhmonitor.example.org">support@mhmonitor.example.org</a></p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize all FAQ cards
            const faqCards = document.querySelectorAll('.faq-card');
            
            faqCards.forEach(card => {
                const question = card.querySelector('.faq-question');
                const answerId = question.getAttribute('aria-controls');
                const answer = document.getElementById(answerId);
                
                // Click handler
                question.addEventListener('click', () => {
                    const isExpanded = question.getAttribute('aria-expanded') === 'true';
                    question.setAttribute('aria-expanded', !isExpanded);
                    card.classList.toggle('active');
                    
                    // Update the toggle icon
                    const icon = question.querySelector('.toggle-icon');
                    icon.textContent = isExpanded ? '+' : '-';
                });
                
                // Keyboard support
                question.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        question.click();
                    }
                });
            });
            
            // Focus management for better keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Tab') {
                    const focusableElements = document.querySelectorAll(
                        'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                    );
                    const firstElement = focusableElements[0];
                    const lastElement = focusableElements[focusableElements.length - 1];
                    
                    if (e.shiftKey && document.activeElement === firstElement) {
                        e.preventDefault();
                        lastElement.focus();
                    } else if (!e.shiftKey && document.activeElement === lastElement) {
                        e.preventDefault();
                        firstElement.focus();
                    }
                }
            });
        });
    </script>
</body>
</html>
